var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},position=function(){function t(){this.posx=0,this.posy=0,this.red=!1,this.id=0}return t.prototype.getposx=function(){return this.posx},t.prototype.getposy=function(){return this.posy},t.prototype.getid=function(){return this.id},t.prototype.getred=function(){return this.red},t.prototype.setpos=function(t,e){this.posx=t,this.posy=e},t.prototype.setid=function(t){this.id=t},t.prototype.setred=function(t){this.red=t},t}();__reflect(position.prototype,"position");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var potpos=new position,id=[],posx=[],posy=[],red=[],currentid=0,Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},e.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.createGameScene=function(){this.initBg(),this.initStart()},e.prototype.initBg=function(){this.SW=this.stage.stageWidth,this.SH=this.stage.stageHeight,this.pw=this.stage.stageWidth,this.ph=this.stage.stageHeight,this.bg=this.createBitmapByName("bg_jpg"),this.stage.addChild(this.bg)},e.prototype.initStart=function(){this.SW=this.stage.stageWidth,this.SH=this.stage.stageHeight,this.btn_start=this.createBitmapByName("btn_start_png"),this.btn_start.x=(this.SW-this.btn_start.width)/2,this.btn_start.y=(this.SH-this.btn_start.height)/2,this.stage.addChild(this.btn_start),this.btn_start.touchEnabled=!0,this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gamestart,this)},e.prototype.initGreypot=function(){for(var t=0;9>t;t++){for(var e=0;9>e;e++)this.createGreypot(9*t+e),this.SW+=this.pw,id[9*t+e]=9*t+e,posx[9*t+e]=this.px,posy[9*t+e]=this.py,red[t+e]=!1;t%2==1?this.SW=this.stage.stageWidth:this.SW=this.stage.stageWidth+this.pw/2,this.SH=this.stage.stageHeight+this.ph*(t+1)}},e.prototype.initRedpot=function(){for(var t=Math.floor(10*Math.random())+10,e=[],i=0;t>i;i++)e[i]=Math.floor(81*Math.random());for(var i=0;t>i;i++)this.createRedpot(posx[e[i]],posy[e[i]])},e.prototype.initCat=function(){this.cat0=this.createBitmapByName("stand_png"),this.cat0.x=posx[40]+this.pw/2,this.cat0.y=posy[40]+this.ph/2,this.stage.addChild(this.cat0),this.cat0.touchEnabled=!0,this.cat0.addEventListener(egret.Event.ENTER_FRAME,this.removeCat,this)},e.prototype.removeCat=function(){this.stage.addChild(this.cat),this.stage.removeChild(this.cat0)},e.prototype.createGreypot=function(t){currentid=t;var e=this.createBitmapByName("pot1_png");this.cat=this.createBitmapByName("stand_png"),this.pw=e.width+5,this.ph=e.height,e.x=this.SW-620+this.pw,this.px=e.x,e.y=this.SH-568+this.ph,this.py=e.y,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.moveCat,this),this.stage.addChild(e)},e.prototype.createRedpot=function(t,e){var i=this.createBitmapByName("pot2_png");i.x=t,i.y=e,this.stage.addChild(i)},e.prototype.createcat=function(){this.createBitmapByName("stand_png")},e.prototype.moveCat=function(){this.cat=this.createBitmapByName("stand_png");for(var t=currentid;t>8;)t-=9;if(t%2==0){var e;!function(t){t[t.left=currentid-1]="left",t[t.right=currentid+1]="right",t[t.leftup=currentid-9]="leftup",t[t.rightup=currentid-8]="rightup",t[t.leftdown=currentid+9]="leftdown",t[t.rightdown=currentid+10]="rightdown"}(e||(e={})),red[e.left]?red[e.right]||(this.cat.x=posx[e.right],this.cat.y=posy[e.right]):(this.cat.x=posx[e.left],this.cat.y=posy[e.left])}else{var e;!function(t){t[t.left=currentid-1]="left",t[t.right=currentid+1]="right",t[t.leftup=currentid-10]="leftup",t[t.rightup=currentid-9]="rightup",t[t.leftdown=currentid+8]="leftdown",t[t.rightdown=currentid+9]="rightdown"}(e||(e={}))}},e.prototype.gamestart=function(){this.stage.removeChild(this.btn_start),this.initGreypot(),this.initRedpot(),this.initCat()},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.startAnimation=function(t){var e=this,i=new egret.HtmlTextParser,o=t.map(function(t){return i.parse(t)}),s=this.textfield,r=-1,n=function(){r++,r>=o.length&&(r=0);var t=o[r];s.textFlow=t;var i=egret.Tween.get(s);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(n,e)};n()},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");