var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var id=[],posx=[],posy=[],red=[],tempcatx=0,tempcaty=0,tempcatid=40,temppotid=0,count=0,flag,Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},e.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.createGameScene=function(){this.bg=this.createBitmapByName("bg_jpg"),this.btn_start=this.createBitmapByName("btn_start_png"),this.victory=this.createBitmapByName("victory_png"),this.defeat=this.createBitmapByName("failed_png"),this.again=this.createBitmapByName("replay_png");var t=RES.getRes("stay_json"),e=RES.getRes("stay_png"),i=new egret.MovieClipDataFactory(t,e);this.mc1=new egret.MovieClip(i.generateMovieClipData("stay")),this.initBg(),this.initStart()},e.prototype.initBg=function(){this.SW=this.stage.stageWidth,this.SH=this.stage.stageHeight,this.pw=this.stage.stageWidth,this.ph=this.stage.stageHeight,this.stage.addChild(this.bg)},e.prototype.initStart=function(){this.SW=this.stage.stageWidth,this.SH=this.stage.stageHeight,this.btn_start.x=(this.SW-this.btn_start.width)/2,this.btn_start.y=(this.SH-this.btn_start.height)/2,this.btn_start.touchEnabled=!0,this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gamestart,this),this.stage.addChild(this.btn_start)},e.prototype.initGreypot=function(){for(var t=0;9>t;t++){for(var e=0;9>e;e++)this.createGreypot(9*t+e),this.SW+=this.pw,id[9*t+e]=9*t+e,posx[9*t+e]=this.px,posy[9*t+e]=this.py,red[t+e]=!1;t%2==1?this.SW=this.stage.stageWidth:this.SW=this.stage.stageWidth+this.pw/2,this.SH=this.stage.stageHeight+this.ph*(t+1)}tempcatx=posx[40],tempcaty=posy[40]},e.prototype.initRedpot=function(){for(var t=Math.floor(10*Math.random())+10,e=[],i=0;t>i;i++)e[i]=Math.floor(81*Math.random());for(var i=0;t>i;i++)40!=e[i]&&(this.createRedpot(posx[e[i]],posy[e[i]]),red[e[i]]=!0)},e.prototype.removeCat=function(){this.stage.removeChild(this.mc1),this.moveCat(),count++},e.prototype.createGreypot=function(t){var e=this.createBitmapByName("pot1_png");this.pw=e.width+5,this.ph=e.height,e.x=this.SW-620+this.pw,this.px=e.x,e.y=this.SH-568+this.ph,this.py=e.y,this.stage.addChild(e)},e.prototype.createRedpot=function(t,e){var i=this.createBitmapByName("pot2_png");i.x=t,i.y=e,this.stage.addChild(i)},e.prototype.touch=function(){this.bg.touchEnabled=!0,this.bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toRed,this),this.bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.removeCat,this)},e.prototype.toRed=function(t){var e=t.localX,i=t.localY;this.SH2=this.stage.stageHeight-568+this.ph;var s=Math.floor((i-this.SH2)/this.ph),h=0;s%2==0?(this.SW2=this.stage.stageWidth-620+this.pw,h=Math.floor((e-this.SW2)/this.pw)):(this.SW2=this.stage.stageWidth-620+1.5*this.pw,h=Math.floor((e-this.SW2)/this.pw)),temppotid=9*s+h,this.createRedpot(posx[temppotid],posy[temppotid]),red[temppotid]=!0},e.prototype.moveCat=function(){this.mc1.x=tempcatx,this.mc1.y=tempcaty,this.stage.addChild(this.mc1),this.mc1.gotoAndPlay(0,-1);var t,e=tempcatid;for(function(t){t[t.left=39]="left",t[t.right=41]="right",t[t.leftup=31]="leftup",t[t.rightup=32]="rightup",t[t.leftdown=49]="leftdown",t[t.rightdown=50]="rightdown"}(t||(t={}));e>8;)e-=9;if(e%2==0){var i;!function(t){t[t.left=tempcatid-1]="left",t[t.right=tempcatid+1]="right",t[t.leftup=tempcatid-9]="leftup",t[t.rightup=tempcatid-9]="rightup",t[t.leftdown=tempcatid+9]="leftdown",t[t.rightdown=tempcatid+9]="rightdown"}(i||(i={})),red[i.leftup]?red[i.left]?red[i.right]?red[i.rightup]?red[i.rightdown]?red[i.leftdown]?this.win():((id[i.leftdown]>=0&&id[i.leftdown]<=8||id[i.leftdown]>=72&&id[i.leftdown]<=80||id[i.leftdown]%9==0||id[i.leftdown]%9==8)&&this.lose(),this.mc1.x=posx[i.leftdown],this.mc1.y=posy[i.leftdown],tempcatid=i.leftdown):((id[i.rightdown]>=0&&id[i.rightdown]<=8||id[i.rightdown]>=72&&id[i.rightdown]<=80||id[i.rightdown]%9==0||id[i.rightdown]%9==8)&&this.lose(),this.mc1.x=posx[i.rightdown],this.mc1.y=posy[i.rightdown],tempcatid=i.rightdown):((id[i.rightup]>=0&&id[i.rightup]<=8||id[i.rightup]>=72&&id[i.rightup]<=80||id[i.rightup]%9==0||id[i.rightup]%9==8)&&this.lose(),this.mc1.x=posx[i.rightup],this.mc1.y=posy[i.rightup],tempcatid=i.rightup):((id[i.right]>=0&&id[i.right]<=8||id[i.right]>=72&&id[i.right]<=80||id[i.right]%9==0||id[i.right]%9==8)&&this.lose(),this.mc1.x=posx[i.right],this.mc1.y=posy[i.right],tempcatid=i.right):((id[i.left]>=0&&id[i.left]<=8||id[i.left]>=72&&id[i.left]<=80||id[i.left]%9==0||id[i.left]%9==8)&&this.lose(),this.mc1.x=posx[i.left],this.mc1.y=posy[i.left],tempcatid=i.left):((id[i.leftup]>=0&&id[i.leftup]<=8||id[i.leftup]>=72&&id[i.leftup]<=80||id[i.leftup]%9==0||id[i.leftup]%9==8)&&this.lose(),this.mc1.x=posx[i.leftup],this.mc1.y=posy[i.leftup],tempcatid=i.leftup),this.stage.addChild(this.mc1)}else{var i;!function(t){t[t.left=tempcatid-1]="left",t[t.right=tempcatid+1]="right",t[t.leftup=tempcatid-9]="leftup",t[t.rightup=tempcatid-9]="rightup",t[t.leftdown=tempcatid+9]="leftdown",t[t.rightdown=tempcatid+9]="rightdown"}(i||(i={})),red[i.leftup]?red[i.left]?red[i.right]?red[i.rightup]?red[i.rightdown]?red[i.leftdown]?this.win():((id[i.leftdown]>=0&&id[i.leftdown]<=8||id[i.leftdown]>=72&&id[i.leftdown]<=80||id[i.leftdown]%9==0||id[i.leftdown]%9==8)&&this.lose(),this.mc1.x=posx[i.leftdown],this.mc1.y=posy[i.leftdown],tempcatid=i.leftdown):((id[i.rightdown]>=0&&id[i.rightdown]<=8||id[i.rightdown]>=72&&id[i.rightdown]<=80||id[i.rightdown]%9==0||id[i.rightdown]%9==8)&&this.lose(),this.mc1.x=posx[i.rightdown],this.mc1.y=posy[i.rightdown],tempcatid=i.rightdown):((id[i.rightup]>=0&&id[i.rightup]<=8||id[i.rightup]>=72&&id[i.rightup]<=80||id[i.rightup]%9==0||id[i.rightup]%9==8)&&this.lose(),this.mc1.x=posx[i.rightup],this.mc1.y=posy[i.rightup],tempcatid=i.rightup):((id[i.right]>=0&&id[i.right]<=8||id[i.right]>=72&&id[i.right]<=80||id[i.right]%9==0||id[i.right]%9==8)&&this.lose(),this.mc1.x=posx[i.right],this.mc1.y=posy[i.right],tempcatid=i.right):((id[i.left]>=0&&id[i.left]<=8||id[i.left]>=72&&id[i.left]<=80||id[i.left]%9==0||id[i.left]%9==8)&&this.lose(),this.mc1.x=posx[i.left],this.mc1.y=posy[i.left],tempcatid=i.left):((id[i.leftup]>=0&&id[i.leftup]<=8||id[i.leftup]>=72&&id[i.leftup]<=80||id[i.leftup]%9==0||id[i.leftup]%9==8)&&this.lose(),this.mc1.x=posx[i.leftup],this.mc1.y=posy[i.leftup],tempcatid=i.leftup),this.stage.addChild(this.mc1)}},e.prototype.win=function(){this.victory.x=(this.stage.width-this.victory.width)/2,this.victory.y=(this.stage.height-this.victory.height)/2,this.stage.addChild(this.victory),this.wintxt=new egret.TextField,this.wintxt.size=20,this.wintxt.width=300,this.wintxt.height=100,this.wintxt.textColor=65280,this.wintxt.x=(this.stage.width-this.wintxt.width)/2,this.wintxt.y=(this.stage.height-this.wintxt.height)/2+100,this.wintxt.text="围住神经猫！！！\n你这么吊家里人知道吗？",this.stage.addChild(this.wintxt),count=0,flag=!0,this.replay()},e.prototype.lose=function(){this.defeat.x=(this.stage.width-this.defeat.width)/2,this.defeat.y=(this.stage.height-this.defeat.height)/2,this.stage.addChild(this.defeat),this.defeattxt=new egret.TextField,this.defeattxt.size=20,this.defeattxt.width=300,this.defeattxt.height=100,this.defeattxt.textColor=65280,this.defeattxt.x=(this.stage.width-this.defeattxt.width)/2,this.defeattxt.y=(this.stage.height-this.defeattxt.height)/2+100,this.defeattxt.text="神经猫跑了！！！\n精神病人从来都说自己没病2333",this.stage.addChild(this.defeattxt),count=0,flag=!1,this.replay()},e.prototype.replay=function(){this.again.x=(this.stage.width-this.again.width)/2,this.again.y=.8*this.stage.height,this.stage.addChild(this.again),this.again.$touchEnabled=!0,this.again.addEventListener(egret.TouchEvent.TOUCH_TAP,this.createGameScene2,this)},e.prototype.createGameScene2=function(){tempcatid=40;for(var t=0;81>t;t++)red[t]=!1;this.bg=this.createBitmapByName("bg_jpg"),this.btn_start=this.createBitmapByName("btn_start_png"),this.victory=this.createBitmapByName("victory_png"),this.defeat=this.createBitmapByName("failed_png"),this.again=this.createBitmapByName("replay_png");var e=RES.getRes("stay_json"),i=RES.getRes("stay_png"),s=new egret.MovieClipDataFactory(e,i);this.mc1=new egret.MovieClip(s.generateMovieClipData("stay")),this.initBg(),this.initStart()},e.prototype.gamestart=function(){this.stage.removeChild(this.btn_start),this.initGreypot(),this.mc1.x=posx[40],this.mc1.y=posy[40],this.stage.addChild(this.mc1),this.initRedpot(),this.touch()},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.startAnimation=function(t){var e=this,i=new egret.HtmlTextParser,s=t.map(function(t){return i.parse(t)}),h=this.textfield,o=-1,r=function(){o++,o>=s.length&&(o=0);var t=s[o];h.textFlow=t;var i=egret.Tween.get(h);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(r,e)};r()},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");